<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Base R graphics</title>
    <meta charset="utf-8" />
    <meta name="author" content="Marcin Kierczak | 06-Nov-2020" />
    <meta name="keywords" content="bioinformatics, course, scilifelab, nbis, R" />
    <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
    <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
    <link id="font-awesome-1-attachment" rel="attachment" href="site_libs/font-awesome-5.1.0/fonts/fontawesome-webfont.ttf"/>
    <link rel="stylesheet" href="assets/slide.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Base R graphics
## R Foundations for Life Scientists
### <b>Marcin Kierczak</b> | 06-Nov-2020
### NBIS, SciLifeLab

---


exclude: true
count: false


&lt;link href="https://fonts.googleapis.com/css?family=Roboto|Source+Sans+Pro:300,400,600|Ubuntu+Mono&amp;amp;subset=latin-ext" rel="stylesheet"&gt;
&lt;link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous"&gt;





&lt;!-- ------------ Only edit title, subtitle &amp; author above this ------------ --&gt;





---
name: ex1_graphics
## Example graphics

.pull-left-50[
.size-80[![](data/slide_base_graphics/world.png)]

Stability of the climate (courtesy of Dr. Mats Pettersson).
]

--

.pull-right-50[
.size-80[![](data/slide_base_graphics/Face_of_Asia.png)]
]

---
name: ex2_graphics
## Example graphics

.pull-left-50[
![](data/slide_base_graphics/airports_pl.png)

]

--

.pull-right-50[
![](data/slide_base_graphics/gapminder.png)
]

---
name: grapgical_devices
class: spaced
## Graphical devices

The concept of a **graphical device** is crucial for understanding R graphics.  
  
--
A device can be a screen (default) or a file. Some R packages introduce their own devices, e.g. Cairo device.
  
--
Creating a plot entails:
* opening a graphical device (not necessary for plotting on screen),

--
* plotting to the graphical device,

--
* closing the graphical device (very important!)

___

--

### The most commonly used graphical devices are:
* screen,
* bitmap/raster devices: `png()`, `bmp()`, `tiff()`, `jpeg()`
* vector devices: `svg()`, `pdf()`,
* `Cairo` versions of the above devices &amp;ndash; for Windows users they offer higher quality graphics,
  

--
For more information visit [this link](http://stat.ethz.ch/R-manual/R-devel/library/grDevices/html/Devices.html).

---
name: working_with_graphical_devs
class: spaced
## Working with graphical devices


```r
png(filename = 'myplot.png', width = 320, height = 320, antialias = T)
plot(x=c(1,2,7), y=c(2,3,5))
dev.off()
```
--
What we did was, in sequence:
* open a graphical device, here `png()` with some parameters,
* do the actual plotting to the device using `plot()` and
* close the graphical device using `dev.off()`.

--
&gt; It is of paramount importance to remember to close graphical devices. Otherwise, our plots may end up in some random weird files or on screens.

---
name: std_viewport
##Standard graphical device viewport
  
.size-60[![](data/slide_base_graphics/rmargins_sf.png)]
.small[source: rgraphics.limnology.wisc.edu]

---
name: plot_basics

##`base::plot()` basics 
`base::plot()` is a basic command that lets you visualize your data and results. It is very powerful yet takes some effort to fully master it. Let's begin with plotting three points: 
* A(1,2); 
* B(2,3); 
* C(7,5).
.size-40[

```r
plot(x=c(1,2,7), y=c(2,3,5))
```

&lt;img src="slide_base_graphics_files/figure-html/plot1-1.svg" style="display: block; margin: auto;" /&gt;
]

---
name: plot_data_frame
## Anatomy of a plot &amp;mdash; episode 1

For convenience, we will create a data frame with our points:
.pull-left-50[

```r
df &lt;- data.frame(x=c(1,2,7), y=c(2,3,5), 
row.names=c("A","B","C"))
df
```

```
##   x y
## A 1 2
## B 2 3
## C 7 5
```
]
.pull-right-50[

```r
plot(df)
```

&lt;img src="slide_base_graphics_files/figure-html/unnamed-chunk-3-1.svg" style="display: block; margin: auto;" /&gt;
]

---
name: plot_anatomy_2
## Anatomy of a plot &amp;mdash; episode 2

.pull-left-50[
There is many parameters one can set in `plot()`. Let's have a closer look at some of them:
* pch &amp;ndash; type of the plotting symbol
* col &amp;ndash; color of the points
* cex &amp;ndash; scale for points
* main &amp;ndash; main title of the plot
* sub &amp;ndash; subtitle of the plot
* xlab &amp;ndash; X-axis label
* ylab &amp;ndash; Y-axis label
* las &amp;ndash; axis labels orientation
* cex.axis &amp;ndash; axis lables scale
]
.pull-right-50[
Let's make our plot a bit fancier...

```r
plot(df, pch=c(15,17,19), 
col=c("tomato", "slateblue"), # recycling rule in action!
main="Three points", sub="Stage 1")
```

&lt;img src="slide_base_graphics_files/figure-html/plot2-1.svg" style="display: block; margin: auto;" /&gt;
]

---
name: gr_param
## Graphical parameters
Graphical parameters can be set in two different ways: 
* as plotting function arguments, e.g. `plot(dat, cex = 0.5)`
* using `par()` to set parameters globally

```r
# read current graphical parameters
par()
# first, save the current parameters so that you
# can set them back if needed
old_par &lt;- par() # should work in theory, practise varies :-(
# now, modify what you want
par(cex.axis = 0.8, bg='grey')
# do your plotting
plot(................)
# restore the old parameters if you want
par(old_par) 
```

---
name: pch_plot
## The `pch` parameter
.size-80[
&lt;img src="slide_base_graphics_files/figure-html/par.pch-1.svg" style="display: block; margin: auto;" /&gt;
]

---
name: pch_cheatsheet_code
## How to make the `pch` cheatsheet

```r
# create a grid of coordinates 
coords &lt;- expand.grid(1:6,1:6)
# make a vector of numerical pch symbols
pch.num &lt;- c(0:25)
# and a vector of character pch symbols
pch.symb &lt;- c('*', '.', 'o', 'O', '0', '-', '+', '|', '%', '#')
# plot numerical pch
plot(coords[1:26,1], coords[1:26,2], pch=pch.num, 
bty='n', xaxt='n', yaxt='n', bg='red',
xlab='', ylab='')
# and character pch's
points(coords[27:36,1], coords[27:36,2], pch=pch.symb)
# label them
text(coords[,1], coords[,2], c(1:26, pch.symb), pos = 1, 
col='slateblue', cex=.8)
```
&gt; Now, make your only cheatsheet for the **lty** parameter!

---
name: layers_1
## Layers
Elements are added to a plot in the same order you plot them.
It is like layers in a graphical program. Think about it! For instance the auxiliary grid lines should be plotted before the actual data points.

.pull-left-50[

```r
# make an empty plot
plot(1:5, type='n', las=1, bty='n')
grid(col='grey', lty=3)
points(1:5, pch=19, cex=3)
abline(h = 3.0, col='red')
```
]
.pull-right-50[
&lt;img src="slide_base_graphics_files/figure-html/gr.layers.ex-1.svg" style="display: block; margin: auto;" /&gt;
]
The line overlaps one data point. It is better to plot it before plotting `points()`

---
name: general_thoughts
class: spaced
## Some thoughts about plotting
There is a few points you should have in mind when working with plots:

--
* raster or vector graphics,

--
* colors, e.g. color-blind people, warm vs. cool colors and optical illusions,

--
* avoid complications, e.g. 3D plots, pie charts etc.,

--
* use black and shades of grey for things you do not need to emphasize, i.e. basically everything except your main result,

--
* avoid 3 axes on one figure.

---
name: many_plots_on_one_fig
## Many plots on one figure
.pull-left-50[

```r
par(mfrow=c(2,3))
plot(1:5)
plot(1:5, pch=19, col='red')
plot(1:5, pch=15, col='blue')
hist(rnorm(100, mean = 0, sd=1))
hist(rnorm(100, mean = 7, sd=3))
hist(rnorm(100, mean = 1, sd=0.5))
par(mfrow=c(1,1))
```
Alternative: use `par(mfcol=c(3,2))`.
]
--
.pull-right-50[
&lt;img src="slide_base_graphics_files/figure-html/mfrow.ex-1.svg" style="display: block; margin: auto;" /&gt;
]

---
name: layout
## Using `graphics::layout()`

.pull-left-50[

```r
M &lt;- matrix(c(1,2,2,2,3,2,2,2), nrow = 2, ncol = 4, byrow = T)
layout(mat = M)
plot(1:5, pch=15, col='blue')
hist(rnorm(100, mean = 0, sd=1))
plot(1:5, pch=15, col='red')
```

```r
M
```

```
##      [,1] [,2] [,3] [,4]
## [1,]    1    2    2    2
## [2,]    3    2    2    2
```
]
--
.pull-right-50[

```r
M &lt;- matrix(c(1,2,2,2,3,2,2,2), nrow = 2, ncol = 4, byrow = T)
layout(mat = M)
plot(1:5, pch=15, col='blue')
hist(rnorm(100, mean = 0, sd=1))
plot(1:5, pch=15, col='red')
```

&lt;img src="slide_base_graphics_files/figure-html/layout_ex-1.svg" style="display: block; margin: auto;" /&gt;
]

---
name: colors
## Defining colors 


```r
mycol &lt;- c(rgb(0,0,1), 'olivedrab', '#FF0000')
plot(1:3,c(1,1,1), col=mycol, pch=19, cex=3)
points(2,1, col=rgb(0,0,1,0.5), pch=15, cex=5)
```

--
&lt;img src="slide_base_graphics_files/figure-html/color_ex-1.svg" style="display: block; margin: auto;" /&gt;

---
name: palettes
## Color palettes

There some built-in palettes: default, hsv, gray, rainbow, terrain.colors, topo.colors, cm.colors, heat.colors

```r
mypal &lt;- heat.colors(10) 
mypal
pie(x = rep(1, times = 10), col = mypal)
```

```
##  [1] "#FF0000" "#FF2400" "#FF4900" "#FF6D00" "#FF9200" "#FFB600" "#FFDB00"
##  [8] "#FFFF00" "#FFFF40" "#FFFFBF"
```

&lt;img src="slide_base_graphics_files/figure-html/color.pal-1.svg" style="display: block; margin: auto;" /&gt;

---
name: custom_palettes
## Custom color palettes
.pull-left-50[
You can easily create custom palettes:

```r
mypal &lt;- colorRampPalette(c("red", "green", "blue"))
pie(x = rep(1, times = 12), col = mypal(12))
class(mypal)
```

```
## [1] "function"
```

&lt;img src="slide_base_graphics_files/figure-html/color.pal.custom-1.svg" style="display: block; margin: auto;" /&gt;
]
--
.pull-right-50[
&gt; **Note:**`grDevices::colorRampPalette()` returns a function for generating colors based on the defined custom palette!
  
&gt; There is an excellent package `RColorBrewer` that offers a number of pre-made palettes, e.g. color-blind safe palette.
  
&gt; Package `wesanderson` offers palettes based on Wes Anderson's movies:-)
]
  
---
name: boxplot_theory
## Box-and-whiskers plot &amp;mdash; theory
There are also more specialized R functions used for creating specific types of plots. One commonly used is `graphics::boxplot()`
.size-40[.center[![](data/slide_base_graphics/wiki_boxplot.png)]]

&gt; **Rule of thumb.** If median of one boxplot is outside the box of another, the median difference is likely to be significant `\(\alpha = 5\%\)`.

---
name: boxplot
## Box-and-whiskers plot

.pull-left-50[

```r
boxplot(decrease ~ treatment, 
data = OrchardSprays,
log = "y", col = "bisque",
varwidth=T)
```

&lt;img src="slide_base_graphics_files/figure-html/boxplot-1.svg" style="display: block; margin: auto;" /&gt;
]
--
.pull-right-50[
The `add=TRUE` parameter in plots allows you to compose plots using previously plotted stuff! 


```r
attach(InsectSprays)
boxplot(count~spray, data=InsectSprays[spray %in% c("C","F"),], col="lightgray")
boxplot(count~spray, data=InsectSprays[spray %in% c("A","B"),], col="tomato", add=T)
boxplot(count~spray, data=InsectSprays[spray %in% c("D","E"),], col="slateblue", add=T)
detach(InsectSprays)
```

&lt;img src="slide_base_graphics_files/figure-html/boxplot2-1.svg" style="display: block; margin: auto;" /&gt;
]

---
name: vioplot
## Violin plots
Package `vioplot` empowers your graphics repertoire with a variation of box-and-whiskers plot called *violin plot*.  


```r
attach(InsectSprays)
vioplot::vioplot(count[spray=="A"], 
count[spray=="F"], 
col="bisque", 
names=c("A","F"))
detach(InsectSprays)
```

&lt;img src="slide_base_graphics_files/figure-html/vioplot-1.svg" style="display: block; margin: auto;" /&gt;
&gt; A violin plot is very similar to a boxplot, but it also visualizes distribution of your datapoints.

---
name: vcd
## Plotting categorical data

```r
data(Titanic) # Load the data
vcd::mosaic(Titanic, 
            labeling = vcd::labeling_border(rot_labels = c(0,0,0,0))) 
```

&lt;img src="slide_base_graphics_files/figure-html/vcd.titanic-1.svg" style="display: block; margin: auto;" /&gt;
&gt; Package `vcd` provides a lot of ways of visualizing categorical data.

---
name: heatmaps
## Plotting simple heatmaps

```r
heatmap(matrix(rnorm(100, mean = 0, sd = 1), nrow = 10), 
col=terrain.colors(10))
```

&lt;img src="slide_base_graphics_files/figure-html/heatmap-1.svg" style="display: block; margin: auto;" /&gt;

---
name: graph_gallery
## Graph gallery
&gt; For more awesome examples visit: [http://www.r-graph-gallery.com](http://www.r-graph-gallery.com)
![](data/slide_base_graphics/graph_gallery.png)
&lt;!-- --------------------- Do not edit this and below --------------------- --&gt;

---
name: end_slide
class: end-slide, middle
count: false

# Now you know a bit more about R!



.end-text[
&lt;p&gt;R version 4.0.3 (2020-10-10)&lt;br&gt;&lt;p&gt;Platform: x86_64-pc-linux-gnu (64-bit)&lt;/p&gt;&lt;p&gt;OS: Ubuntu 18.04.5 LTS&lt;/p&gt;&lt;br&gt;

&lt;hr&gt;

&lt;span class="small"&gt;Built on : &lt;i class='fa fa-calendar' aria-hidden='true'&gt;&lt;/i&gt; 06-Nov-2020 at &lt;i class='fa fa-clock-o' aria-hidden='true'&gt;&lt;/i&gt; 15:16:16&lt;/span&gt;  

&lt;b&gt;2020&lt;/b&gt; • [SciLifeLab](https://www.scilifelab.se/) • [NBIS](https://nbis.se/)
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="assets/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "4:3",
"highlightLanguage": "r",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "%current%/%total%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
