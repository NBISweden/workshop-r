<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>

  <meta name="theme-color" content="#ffffff">

  <title>Loops in R</title>
  <meta name="description" content="">

  <link rel="canonical" href="./Exercises/Loops.html">
  <!-- CSS  -->
  <link href="//fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">

    <!-- Custom Fonts -->
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>

    <link href="./workshop-common/css/main.css" type="text/css" rel="stylesheet" media="screen,projection"/>
</head>

  <body>
    <!-- define dropdowns first -->

  

  

  

  


<div>
  <nav class="z-depth-0  main  " role="navigation">
    <div class="nav-wrapper">
      <a href="./" class="left navlogo"><img src="./workshop-common/assets/img/logo/nbislogo-green.svg" style="height:48px;margin-top:8px;padding:0px;margin-left:8px"></a>
      <ul class="right hide-on-med-and-down">
      
        
          <li><a href="./index.html">Overview</a></li>
        
      
        
          <li><a href="./schedule.html">Schedule</a></li>
        
      
        
          <li><a href="./precourse.html">Pre-course material</a></li>
        
      
        
          <li><a href="./travel.html">Travel info</a></li>
        
      
      </ul>

      <a href="#" data-activates="nav-mobile" class="button-collapse right"><i class="material-icons">menu</i></a>
    </div>
  </nav>
</div>
      <ul id="nav-mobile" class="side-nav">
      
        
          <li class="no-padding"><a style="padding: 0px 16px" href="./index.html">Overview</a></li>
        
      
        
          <li class="no-padding"><a style="padding: 0px 16px" href="./schedule.html">Schedule</a></li>
        
      
        
          <li class="no-padding"><a style="padding: 0px 16px" href="./precourse.html">Pre-course material</a></li>
        
      
        
          <li class="no-padding"><a style="padding: 0px 16px" href="./travel.html">Travel info</a></li>
        
      
      </ul>


  
  <div class="l2 s12">
    <div id="toc-sidebar">
        <ul id="toc"></ul>
    </div>
</div>

  
  <div class="container">
    <div class="row"></div>
    <div class="row">
      
      <div class="col s12 l10 z-depth-2 content">
      
        <h1 id="loops-in-r">Loops in R</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="#orgheadline2">1. Introduction</a>
<ul>
<li><a href="#orgheadline1">1.1. Exercises: Loop structures</a></li>
</ul>
</li>
</ul>
</div>
</div>

<h1 id="introduction">Introduction<a id="orgheadline2"></a>
</h1>

<p>In programming languages loop structures, either with or without
conditions, are used to repeat commands over multiple entities. For
and while loops as well as if-else statements are also often used in
R, but not as often as in many other programming languages. The reason
for this is that many needs of the loops are addressed using
vectorization or via apply functions.</p>

<p>This means that we can multiply all values in a vector in R by two, just
call:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vec.a &lt;- c(1, 2, 3, 4)
vec.a * 2

[1] 2 4 6 8
</code></pre></div></div>

<p>In many other and languages as well as in R you can also create this
with a loop instead</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for (i in vec.a) {
    vec.a[i] &lt;- vec.a[i] * 2
    }
vec.a

[1] 2 4 6 8
</code></pre></div></div>

<p>As you saw in the lecture this is far less efficient and not by any
means easier to type and we hence tend avoid loops when possible.</p>

<p>After this exercise you should know:</p>
<ul>
  <li>What are the most common loop structures in R</li>
  <li>Some common alternatives to using loops in R</li>
  <li>How one can convert a short script to a function.</li>
  <li>Use that new function in R.</li>
</ul>

<h2 id="exercises-loop-structures">Exercises: Loop structures<a id="orgheadline1"></a>
</h2>

<ol>
  <li>Create a 100000 by 10 matrix with the numbers 1:1000000. Make a
for-loop that calculates the sum for each row of the
matrix. Verify that your results are consistent with what you
obtain with the apply function to calculate row sums as well as
with the built-in rowSums function. These functions were discussed
in the lecture “Elements of the programming language - part 2”
    <details>
<summary><img class="emoji" title=":key:" alt=":key:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f511.png" height="20" width="20"> Click to see how</summary>
<pre>
    X &lt;- matrix(1:1000000, nrow = 100000, ncol = 10)
    for.sum &lt;- vector()
    # Note that this loop is much faster if you outside the loop create an empty vector of the right size.
    # rwmeans &lt;- vector('integer', 100000)
    for (i in 1:nrow(X)) {
        for.sum[i] &lt;- sum(X[i,])
    }
    head(for.sum)
    
    [1] 4500010 4500020 4500030 4500040 4500050 4500060
</pre>
</details>
    <p><br></p>
    <details>
<summary><img class="emoji" title=":key:" alt=":key:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f511.png" height="20" width="20"> Click to see Apply</summary>
<pre>
    app.sum &lt;- apply(X, MARGIN = 1, sum)
    head(app.sum)
    
    [1] 4500010 4500020 4500030 4500040 4500050 4500060

</pre>
</details>
    <p><br></p>
    <details>
<summary><img class="emoji" title=":key:" alt=":key:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f511.png" height="20" width="20"> Click to see RowSums</summary>
<pre>	
    rowSums.sum &lt;- rowSums(X)
    head(rowSums.sum)
    
    [1] 4500010 4500020 4500030 4500040 4500050 4500060
    
</pre>
</details>
    <p><br></p>
    <details>
<summary><img class="emoji" title=":key:" alt=":key:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f511.png" height="20" width="20"> Click to see how to check if methods are generating the same res.</summary>
<pre>
		
    identical(for.sum, app.sum)
    identical(for.sum, rowSums.sum)
    identical(for.sum, as.integer(rowSums.sum))
    
    [1] TRUE
    [1] FALSE
    [1] TRUE

</pre>
</details>
    <p><br></p>
  </li>
  <li>Another common loop structure that is used is the while loop, which
functions much like a for loop, but will only run as
long as a test condition is TRUE. Modify your for loop from
exercise 1 and make it into a while loop.
    <details>
<summary><img class="emoji" title=":key:" alt=":key:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f511.png" height="20" width="20"> Click to see how</summary>
<pre>
    x &lt;- 1
    while.sum &lt;- vector("integer", 100000)
    while (x &lt; 100000) {
        while.sum[x] &lt;- sum(X[x,])
        x &lt;- x + 1
        }
    head(while.sum)
    
    [1] 4500010 4500020 4500030 4500040 4500050 4500060

</pre>
</details>
    <p><br></p>
  </li>
  <li>
    <p>Create a data frame with two numeric and one character
vector. Write a loop that loops over the columns and reports the
sum of the column values if it is numeric and the total number of
characters if it is a character vector.</p>

    <details>
<summary><img class="emoji" title=":key:" alt=":key:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f511.png" height="20" width="20"> Click to see how</summary>
<pre>
	
    vector1 &lt;- 1:10
    vector2 &lt;- c("Odd", "Loop", letters[1:8])
    vector3 &lt;- rnorm(10, sd = 10)
    df1 &lt;- data.frame(vector1, vector2, vector3, stringsAsFactors = FALSE)
    sum.vec &lt;- vector()
    for (i in 1:ncol(df1)) {
        if (is.numeric(df1[,i])) {
            sum.vec[i] &lt;- sum(df1[,i])
        } else {
            sum.vec[i] &lt;- sum(nchar(df1[,i]))
        }
    }
    sum.vec
    
    [1]  5.500000 15.000000  2.727954
</pre>
</details>
    <p><br></p>
  </li>
  <li>
    <p>In question 3 you generated a loop to go over a data frame. Try to
convert this code to a function in R. The function should take a
single data frame name as argument.</p>

    <details>
<summary><img class="emoji" title=":key:" alt=":key:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f511.png" height="20" width="20"> Click to see how</summary>
<pre>
    df.info &lt;- function(df) {
        sum.vec &lt;- vector()
        for (i in 1:ncol(df)) {
            if (is.numeric(df[,i])) {
                sum.vec[i] &lt;- mean(df[,i])
                } else {
                sum.vec[i] &lt;- sum(nchar(df[,i]))
                }
            }
        sum.vec
    }
</pre>
</details>
    <p><br></p>
  </li>
  <li>
    <p>Read up on the ifelse function in R. If possible use the ifelse function
to answer question 3.</p>
  </li>
  <li>
    <p>In all loops that we tried out we have created the variable where
the output is saved outside the loop. Why is this?</p>
  </li>
  <li>
    <p><strong>Advanced exercise</strong>
At the lecture an approach to calculate factorials were
implemented using recursion (function calling itself). Here we
instead will have a go at generating Fibonacci numbers. A
fibonacci number is part of a series of number with the following
properties:</p>

    <p>The first two numbers in the Fibonacci sequence are either 1 and
1, or 0 and 1, depending on the chosen starting point of the
sequence, and each subsequent number is the sum of the previous
two. Hence:</p>

    <p>0, 1, 1, 2, 3, 5, 8, 13, 21, …
or
1, 1, 2, 3, 5, 8, 13, 21, …</p>

    <p>Try to generate such a series using a recursive approach</p>
  </li>
</ol>

      </div>
    </div>
  </div>

    <footer class="page-footer topborder">
    <div class="container">
      <div class="row">
        <div class="col s12">
          <h5 class="white-text">NBIS</h5>
          <p class="grey-text text-lighten-4">NBIS is a distributed national bioinformatics infrastructure, supporting life sciences in Sweden.</p>
        </div>
      </div>
    </div>
    <div id="funding" class="row">
      <div class="center-block">
        <p class="logos">
          <a href="http://www.vr.se"><img alt="Vetenskapsrådet" src="./workshop-common/assets/img/logo/vetenskapsradet-logotyp.png" style="height:65px;padding:5px"></a>
          <a href="http://www.scilifelab.se"><img alt="Scilifelab" src="./workshop-common/assets/img/logo/scilifelab.jpg" style="height:40px;padding:5px 0px 5px 0px"></a>
          <a href="http://www.liu.se"><img alt="Linköping University" src="./workshop-common/assets/img/logo/liu.jpg" style="height:65px;padding:5px"></a>
          <a href="http://www.chalmers.se"><img alt="Chalmers University" src="./workshop-common/assets/img/logo/chalmers.png" style="height:65px;padding:5px"></a>
          <a href="http://www.gu.se"><img alt="University of Gothenburg" src="./workshop-common/assets/img/logo/gu.jpg" style="height:65px;padding:5px"></a>
          <a href="http://www.ki.se"><img alt="Karolinska Institutet" src="./workshop-common/assets/img/logo/ki.png" style="height:65px;padding:0px 5px 0px 5px"></a>
          <a href="http://www.kth.se"><img alt="KTH Royal Institute of Technology" src="./workshop-common/assets/img/logo/kth.png" style="height:65px;padding:5px"></a>
          <a href="http://www.lu.se"><img alt="Lund University" src="./workshop-common/assets/img/logo/lu.jpg" style="height:65px;padding:5px 0px 5px 0px"></a>
          <a href="http://www.nrm.se"><img alt="Swedish Museum of Natural History" src="./workshop-common/assets/img/logo/nrm.gif" style="height:65px;padding:0px 0px 0px 0px"></a>
          <a href="http://www.slu.se"><img alt="Swedish University of Agricultural Sciences" src="./workshop-common/assets/img/logo/slu.png" style="height:65px;padding:0px 5px 0px 0px"></a>
          <a href="http://www.su.se"><img alt="Stockholm University" src="./workshop-common/assets/img/logo/su.png" style="height:65px;padding:5px 0px 5px 5px"></a>
          <a href="http://www.umu.se"><img alt="Umeå University" src="./workshop-common/assets/img/logo/umu.jpg" style="height:65px;padding:5px 0px 5px 0px"></a>
          <a href="http://www.uu.se"><img alt="Uppsala University" src="./workshop-common/assets/img/logo/uu.png" style="height:65px;padding:5px"></a>
          <a href="https://www.wallenberg.com/kaw/en"><img alt="Knuth and Alice Wallenberg Foundation" src="./workshop-common/assets/img/logo/kaw.png" style="height:65px;padding:5px"></a>
          <!-- <a href="http://www.elixir-europe.org"><img alt="ELIXIR" src="./workshop-common/assets/img/logo/elixir.png" style="height:65px;padding:5pxi;float:right" ></a> -->
        </p>
      </div>
    </div>
  </footer>


  <!--  Scripts-->
  

  <script src="//code.jquery.com/jquery-3.1.1.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <!--  Additional scripts for page -->
  

  <!-- This needs to be loaded last -->
  <script src="./workshop-common/assets/js/init.js"></script>


  </body>
</html>
